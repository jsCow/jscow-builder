/* jscow - Javascript Component Framework - jscow-videochat-trunk - Mario Linz - http://www.jscow.de */jsCow.res.components.videochat=function(){};jsCow.res.components.videochat.prototype={init:function(){return this},setDefaultMVC:function(){this.setModel(jsCow.res.model.videochat);this.setView(jsCow.res.view.videochat);this.setController(jsCow.res.controller.videochat);return this},reload:function(){this.globalEvents.trigger("reload",{},this);return this},setChatSender:function(a){if(a){o={chatSenderUrl:a}}else{o={}}this.globalEvents.trigger("setChatSender",o,this);return this},setChatStream:function(a){if(a){o={chatStreamUrl:a}}else{o={}}this.globalEvents.trigger("setChatStream",o,this);return this}};jsCow.res.model.videochat=function(){this.config={globalDisabled:false,enabled:true,chatSenderUrl:false,chatStreamUrl:false,chatType:"SENDER",host:"",id:"",logo:"",width:640,height:480,fsp:25,keyFrameInterval:15,quality:80}};jsCow.res.model.videochat.prototype={init:function(){this.reload({data:this.config});this.globalEvents.trigger("viewInit",this.getConfig(),this.getCmp())},reload:function(c){if(this.isEnabled()){var a=this;this.setConfig(c.data);if(this.getConfig("chatSenderUrl")||this.getConfig("chatStreamUrl")){if(this.getConfig("chatType")=="SENDER"){var b=this.getConfig("chatSenderUrl")}else{var b=this.getConfig("chatStreamUrl")}$.ajax({type:"POST",url:b,data:{video_host:this.getConfig("host"),video_id:this.getConfig("id"),video_logo:this.getConfig("logo"),video_width:this.getConfig("width"),video_height:this.getConfig("height"),video_fsp:this.getConfig("fsp"),video_keyFrameInterval:this.getConfig("keyFrameInterval"),video_quality:this.getConfig("quality")},success:function(d){a.setConfig({request:d});a.globalEvents.trigger("viewUpdate",a.getConfig(),a.getCmp())}})}}},setChatType:function(a){this.setConfig({chatType:a.data})}};jsCow.res.view.videochat=function(){this.execInit=false;this.type="jsCow.res.view.videochat";this.dom={};this.dom.main=$("<div/>").addClass("jscow-videochat");this.dom.videoChatContainer=false};jsCow.res.view.videochat.prototype={init:function(a){var a=a.data;var b=false},update:function(a){var a=a.data;if(a){if(!a.enabled||a.globalDisabled){}else{this.dom.main.find("*").remove();this.dom.main.append(a.request);if(a.hide){this.dom.main.addClass("jscow-hide")}else{this.dom.main.removeClass("jscow-hide")}}}return this}};jsCow.res.controller.videochat=function(){this.type="jsCow.res.controller.videochat"};jsCow.res.controller.videochat.prototype={init:function(){},handleReload:function(a){if(this.isMethodExists(this.getModel().reload)){this.getModel().reload(a)}},handleSetChatSender:function(a){this.getCmp().setConfig(a.data);if(this.isMethodExists(this.getModel().setChatType)){this.getModel().setChatType({data:"SENDER"})}},handleSetChatStream:function(a){this.getCmp().setConfig(a.data);if(this.isMethodExists(this.getModel().setChatType)){this.getModel().setChatType({data:"STREAM"})}}};